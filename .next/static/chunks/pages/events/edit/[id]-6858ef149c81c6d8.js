(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[503],{5562:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/events/edit/[id]",function(){return t(9240)}])},6490:function(e,n,t){"use strict";t.d(n,{Z:function(){return S}});var r=t(5893),s=t(9008),a=t.n(s),i=t(1163),o=t(9583),c=t(7294),d=t(1664),l=t.n(d),u=t(554),h=t.n(u);var f=function(){var e=(0,c.useState)(""),n=e[0],t=e[1],s=(0,i.useRouter)();return(0,r.jsx)("div",{className:h().search,children:(0,r.jsx)("form",{onSubmit:function(e){e.preventDefault(),s.push("/events/search?term=".concat(n)),t("")},children:(0,r.jsx)("input",{type:"text",value:n,onChange:function(e){return t(e.target.value)},placeholder:"Search Events"})})})},v=t(4642),x=t(3695),m=t.n(x);var p=function(){var e=(0,c.useContext)(v.Z),n=e.user,t=e.logout;return(0,r.jsxs)("header",{className:m().header,children:[(0,r.jsx)("div",{className:m().logo,children:(0,r.jsx)(l(),{href:"/",children:(0,r.jsx)("a",{children:"DJ Events"})})}),(0,r.jsx)(f,{}),(0,r.jsx)("nav",{children:(0,r.jsxs)("ul",{children:[(0,r.jsx)("li",{children:(0,r.jsx)(l(),{href:"/events",children:(0,r.jsx)("a",{children:"Events"})})}),n?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("li",{children:(0,r.jsx)(l(),{href:"/events/add",children:(0,r.jsx)("a",{children:"Add Event"})})}),(0,r.jsx)("li",{children:(0,r.jsx)(l(),{href:"/account/dashboard",children:(0,r.jsx)("a",{children:"Dashboard"})})}),(0,r.jsx)("li",{children:(0,r.jsxs)("button",{onClick:function(){return t()},className:"btn-secondary btn-icon",children:[(0,r.jsx)(o.fHX,{})," Logout"]})})]}):(0,r.jsx)("li",{children:(0,r.jsx)(l(),{href:"/account/login",children:(0,r.jsxs)("a",{className:"btn-secondary btn-icon",children:[(0,r.jsx)(o.IPB,{}),"Login"]})})})]})})]})},j=t(7246),b=t.n(j);var _=function(){return(0,r.jsxs)("footer",{className:b().footer,children:[(0,r.jsx)("p",{children:"Copywright \xa9 DJ Events 2022"}),(0,r.jsx)("p",{children:(0,r.jsx)(l(),{href:"/about",children:"About This Project"})})]})},y=t(253),g=t.n(y);var w=function(){return(0,r.jsxs)("div",{className:g().showcase,children:[(0,r.jsx)("h1",{children:"Welcome To The Party!"}),(0,r.jsx)("h2",{children:"Find the hottest DJ Events"})]})},N=t(9134),k=t.n(N);function E(e){var n=e.title,t=e.keywords,s=e.description,o=e.children,c=(0,i.useRouter)();return(0,r.jsxs)("div",{children:[(0,r.jsxs)(a(),{children:[(0,r.jsx)("title",{children:n}),(0,r.jsx)("meta",{name:"description",content:s}),(0,r.jsx)("meta",{name:"keywords",content:t})]}),(0,r.jsx)(p,{}),"/"===c.pathname&&(0,r.jsx)(w,{}),(0,r.jsx)("div",{className:k().container,children:o}),(0,r.jsx)(_,{})]})}E.defaultProps={title:"DJ Events",description:"The coolest events around town",keywords:"DJ, cool, Events"};var S=E},9240:function(e,n,t){"use strict";t.r(n),t.d(n,{__N_SSP:function(){return D},default:function(){return O}});var r=t(4051),s=t.n(r),a=t(5893),i=t(9583),o=t(5675),c=t.n(o),d=t(381),l=t.n(d),u=t(7294),h=t(1163),f=t(782),v=(t(4213),t(1664)),x=t.n(v),m=t(6490),p=t(3935),j=t(8490),b=t.n(j);var _=function(e){var n=e.show,t=e.onClose,r=e.children,s=e.title,o=(0,u.useState)(!1),c=o[0],d=o[1];(0,u.useEffect)((function(){return d(!0)}));var l=n?(0,a.jsx)("div",{className:b().overlay,children:(0,a.jsxs)("div",{className:b().modal,children:[(0,a.jsx)("div",{className:b().header,children:(0,a.jsx)("a",{href:"#",onClick:function(e){e.preventDefault(),t()},children:(0,a.jsx)(i.aHS,{})})}),s&&(0,a.jsx)("div",{children:s}),(0,a.jsx)("div",{className:b().body,children:r})]})}):null;return c?p.createPortal(l,document.getElementById("modal-root")):null},y=t(1645),g=t(7913),w=t.n(g);function N(e,n,t,r,s,a,i){try{var o=e[a](i),c=o.value}catch(d){return void t(d)}o.done?n(c):Promise.resolve(c).then(r,s)}var k=function(e){var n=e.evtId,t=e.imageUploaded,r=e.token,i=(0,u.useState)(null),o=i[0],c=i[1],d=function(){var e,a=(e=s().mark((function e(a){var i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),(i=new FormData).append("files",o),i.append("ref","api::event.event"),i.append("refId",n),i.append("field","image"),i.append("source","users-permissions"),e.next=9,fetch("".concat(y.T,"/upload"),{method:"POST",headers:{Authorization:"Bearer ".concat(r)},body:i});case 9:e.sent.ok&&t();case 11:case"end":return e.stop()}}),e)})),function(){var n=this,t=arguments;return new Promise((function(r,s){var a=e.apply(n,t);function i(e){N(a,r,s,i,o,"next",e)}function o(e){N(a,r,s,i,o,"throw",e)}i(void 0)}))});return function(e){return a.apply(this,arguments)}}();return(0,a.jsxs)("div",{className:w().form,children:[(0,a.jsx)("h1",{children:" Upload event Image "}),(0,a.jsxs)("form",{onSubmit:d,children:[(0,a.jsx)("div",{className:w().file,children:(0,a.jsx)("input",{type:"file",onChange:function(e){console.log(e.target.files[0]),c(e.target.files[0])}})}),(0,a.jsx)("input",{type:"submit",value:"Upload",className:"btn"})]})]})};function E(e,n,t,r,s,a,i){try{var o=e[a](i),c=o.value}catch(d){return void t(d)}o.done?n(c):Promise.resolve(c).then(r,s)}function S(e){return function(){var n=this,t=arguments;return new Promise((function(r,s){var a=e.apply(n,t);function i(e){E(a,r,s,i,o,"next",e)}function o(e){E(a,r,s,i,o,"throw",e)}i(void 0)}))}}function C(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var P=t(1304);var D=!0,O=function(e){var n=e.evt,t=e.token,r=(0,u.useState)({name:n.attributes.name,slug:P(n.attributes.name).toLowerCase(),performers:n.attributes.performers,venue:n.attributes.venue,address:n.attributes.address,date:n.attributes.date,time:n.attributes.time,description:n.attributes.description}),o=r[0],d=r[1],v=(0,u.useState)(n.attributes.image.data?n.attributes.image.data.attributes.url:null),p=v[0],j=v[1],b=(0,u.useState)(!1),g=b[0],N=b[1],E=(0,h.useRouter)(),D=function(){var e=S(s().mark((function e(r){var a,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),o.slug=P(o.name.toLowerCase()),Object.values(o).some((function(e){return""===e}))&&f.Am.error("Please fill in all fields"),e.next=6,fetch("".concat(y.T,"/events/").concat(n.id),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({data:o})});case 6:if((a=e.sent).ok){e.next=14;break}if(403!==a.status&&401!==a.status){e.next=11;break}return f.Am.error("Unauthorized"),e.abrupt("return");case 11:f.Am.error("Something went wrong"),e.next=18;break;case 14:return e.next=16,a.json();case 16:i=e.sent,E.push("/events/".concat(i.data.attributes.slug));case 18:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),O=function(e){var n=e.target,t=n.name,r=n.value;d(function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){C(e,n,t[n])}))}return e}({},o,C({},t,r)))},T=function(){var e=S(s().mark((function e(t){var r,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(y.T,"/events/").concat(n.id,"?populate=%2A"));case 2:return r=e.sent,e.next=5,r.json();case 5:a=e.sent,j(a.data.attributes.image.data.attributes.url),N(!1);case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,a.jsxs)(m.Z,{title:"Edit Event",children:[(0,a.jsx)(x(),{href:"/events",children:"Go Back"}),(0,a.jsx)("h1",{children:"Edit Event"}),(0,a.jsx)(f.Ix,{}),(0,a.jsxs)("form",{onSubmit:D,className:w().form,children:[(0,a.jsxs)("div",{className:w().grid,children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"name",children:"Event Name"}),(0,a.jsx)("input",{type:"text",id:"name",name:"name",value:o.name,onChange:O})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"performers",children:"Performers"}),(0,a.jsx)("input",{type:"text",name:"performers",id:"performers",value:o.performers,onChange:O})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"venue",children:"Venue"}),(0,a.jsx)("input",{type:"text",name:"venue",id:"venue",value:o.venue,onChange:O})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"address",children:"Address"}),(0,a.jsx)("input",{type:"text",name:"address",id:"address",value:o.address,onChange:O})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"date",children:"Date"}),(0,a.jsx)("input",{type:"date",name:"date",id:"date",value:l()(o.date).format("yyyy-MM-DD"),onChange:O})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"time",children:"Time"}),(0,a.jsx)("input",{type:"text",name:"time",id:"time",value:o.time,onChange:O})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"description",children:"Event Description"}),(0,a.jsx)("textarea",{type:"text",name:"description",id:"description",value:o.description,onChange:O})]}),(0,a.jsx)("input",{type:"submit",value:"Update Event",className:"btn"})]}),(0,a.jsx)("h2",{children:"Event Image"}),p?(0,a.jsx)(c(),{src:p,height:100,width:170}):(0,a.jsx)("div",{children:(0,a.jsx)("p",{children:"No image uploaded"})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("button",{onClick:function(){return N(!0)},className:"btn-secondary",children:[(0,a.jsx)(i.H3h,{})," Set Image"]}),(0,a.jsx)(_,{show:g,onClose:function(){return N(!1)},children:(0,a.jsx)(k,{evtId:n.id,imageUploaded:T,token:t})})]})]})}},7246:function(e){e.exports={footer:"Footer_footer__Tl1eP"}},7913:function(e){e.exports={form:"Form_form__mh4_m",file:"Form_file__ZNyJL",grid:"Form_grid___DuXT"}},3695:function(e){e.exports={header:"Header_header__VYZ3G",logo:"Header_logo__6vBZG"}},9134:function(e){e.exports={container:"Layout_container__S4aNf"}},8490:function(e){e.exports={modal:"Modal_modal__yDLSi",header:"Modal_header__iLDRm",body:"Modal_body__prdbO",overlay:"Modal_overlay__C7JRk"}},554:function(e){e.exports={search:"Search_search__t4jaQ"}},253:function(e){e.exports={showcase:"Showcase_showcase__VZOKI"}}},function(e){e.O(0,[445,885,831,675,353,53,774,888,179],(function(){return n=5562,e(e.s=n);var n}));var n=e.O();_N_E=n}]);